{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/blanc/Desktop/lumarVelas/my-app/components/Detail.jsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { supabase } from \"@/utils/supabaseClient\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { addItemToCart } from \"@/store/cartSlice\";\r\nimport { toast } from \"react-toastify\"; // Importamos Toastify\r\n\r\nexport default function ProductDetail() {\r\n  const { id } = useParams();\r\n  const [product, setProduct] = useState(null);\r\n  const [fragances, setFragances] = useState([]);\r\n  const [nextFragances, setNextFragances] = useState([]); // Fragancias proximas\r\n  const [selectedFragance, setSelectedFragance] = useState(null);\r\n  const [selectedNextFragance, setSelectedNextFragance] = useState(null); // Fragancia seleccionada (proximamente)\r\n  const dispatch = useDispatch(); // Para despachar la acción de Redux\r\n\r\n  const fetchProduct = async () => {\r\n    if (!id) return;\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"products\")\r\n        .select(\"*\")\r\n        .eq(\"id\", id)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProduct(data);\r\n      fetchFragances(data.fragance);\r\n      fetchNextFragances(data.next_fragance); // Obtener las fragancias proximas\r\n    } catch (error) {\r\n      console.error(\"Error al obtener el producto:\", error);\r\n    }\r\n  };\r\n\r\n  const fetchFragances = async (fraganceIds) => {\r\n    try {\r\n      if (!fraganceIds || fraganceIds.length === 0) return;\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"fragances\")\r\n        .select(\"id, name, description, color, intensity\")\r\n        .in(\"id\", fraganceIds);\r\n\r\n      if (error) throw error;\r\n      setFragances(data);\r\n    } catch (error) {\r\n      console.error(\"Error al obtener las fragancias:\", error);\r\n    }\r\n  };\r\n\r\n  const fetchNextFragances = async (nextFraganceIds) => {\r\n    try {\r\n      if (!nextFraganceIds || nextFraganceIds.length === 0) return;\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"fragances\")\r\n        .select(\"id, name, description, color, intensity\")\r\n        .in(\"id\", nextFraganceIds);\r\n\r\n      if (error) throw error;\r\n      setNextFragances(data);\r\n    } catch (error) {\r\n      console.error(\"Error al obtener las fragancias proximas:\", error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProduct();\r\n  }, [id]);\r\n\r\n  if (!product) {\r\n    return <p>Cargando producto...</p>;\r\n  }\r\n\r\n  // Función para manejar la adición al carrito\r\n  const handleAddToCart = () => {\r\n    if (!product) return;\r\n\r\n    // Asegúrate de que la fragancia seleccionada esté en fragances\r\n    if (!selectedFragance && !selectedNextFragance) {\r\n      toast.error(\"Por favor, selecciona una fragancia disponible.\"); // Toastify Error\r\n      return;\r\n    }\r\n\r\n    const item = {\r\n      id: product.id,\r\n      name: product.name,\r\n      price: product.price,\r\n      img: product.image_url,\r\n      fragance: selectedFragance.name ? selectedFragance.name : selectedNextFragance.name,\r\n      quantity: 1,\r\n    };\r\n    dispatch(addItemToCart(item)); // Despachamos la acción para agregar el producto al carrito\r\n    toast.success(`${product.name} añadido al carrito`);\r\n  };\r\n\r\n  // Función para calcular el porcentaje de descuento\r\n  const calculateDiscountPercentage = () => {\r\n    if (product.old_price && product.old_price > 0) {\r\n      const discount = ((product.old_price - product.price) / product.old_price) * 100;\r\n      return Math.round(discount); // Redondear el porcentaje\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"bg-verde h-[60px] sm:h-[70px] md:h-[130px] lg:h-[180px] xl:h-[100px] w-full\"></div>\r\n      <div className=\"max-w-4xl mx-auto py-8 px-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n          {/* Imagen del producto */}\r\n                      <div className=\"w-full relative group\">\r\n                        <Image\r\n                          src={product.image_url}\r\n                          alt={product.name}\r\n                          width={400}\r\n                          height={600}\r\n                          className=\"w-full h-[300px] md:h-[350px] lg:h-[400px] rounded-md object-cover transition-opacity duration-300 group-hover:opacity-0\"\r\n                        />\r\n                        <Image\r\n                          src={product.image1_url}\r\n                          alt={product.name}\r\n                          width={400}\r\n                          height={600}\r\n                          className=\"w-full h-[300px] md:h-[350px] lg:h-[400px] rounded-md object-cover absolute top-0 left-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300\"\r\n                        />\r\n                      </div>\r\n          \r\n          {/* Detalles del producto */}\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold mb-4\">{product.name}</h1>\r\n\r\n           \r\n\r\n            \r\n\r\n            <p className=\"text-gray-600 mb-4\">{product.description}</p>\r\n\r\n            {/* Precio Actual, Precio Anterior (tachado) y Precio Promocional */}\r\n            <div className=\"mb-3\">\r\n              <span className=\"text-2xl font-semibold text-black mr-1\">\r\n                ${product.price}\r\n              </span>\r\n\r\n              {/* Precio anterior tachado */}\r\n              {product.old_price && (\r\n                <span className=\"text-md text-gray-500 line-through\">\r\n                  ${product.old_price}\r\n                </span>\r\n              )}\r\n\r\n              {/* Mostrar el porcentaje de descuento */}\r\n              {product.old_price && (\r\n                <span className=\"text-xl text-red-600 ml-2\">\r\n                  {calculateDiscountPercentage()}%\r\n                </span>\r\n              )}\r\n            </div>\r\n\r\n            {/* Precio Promocional */}\r\n            {product.promotional_price && (\r\n              <div className=\"text-sm text-green-600 font-semibold\">\r\n                <p className=\"text-lg text-gray-600\">\r\n                  ${product.promotional_price} Pagando en efectivo o transferencia\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {/* Mostrar fragancias disponibles y proximas en un mismo grid */}\r\n            {fragances.length > 0 || nextFragances.length > 0 ? (\r\n              <div className=\"mt-2\">\r\n                <h2 className=\"text-xl font-semibold mb-4\">Fragancias:</h2>\r\n                <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-1\">\r\n                  {/* Fragancias disponibles */}\r\n                  {fragances.map((fragance) => (\r\n                    <button\r\n                      key={fragance.id}\r\n                      onClick={() => {\r\n                        setSelectedFragance(fragance);\r\n                        setSelectedNextFragance(null);\r\n                      }}\r\n                      className=\"flex flex-col items-center justify-center py-2 px-5 rounded-lg border-2 border-gray-300 w-max\"\r\n                      style={{ backgroundColor: fragance.color }}\r\n                    >\r\n                      <span className=\"text-white font-semibold\">{fragance.name}</span>\r\n                    </button>\r\n                  ))}\r\n                  {/* Fragancias proximas */}\r\n                  {nextFragances.map((fragance) => (\r\n                    <button\r\n                      key={fragance.id}\r\n                      onClick={() => {\r\n                        setSelectedNextFragance(fragance);\r\n                        setSelectedFragance(null);\r\n                      }}\r\n                      className=\"flex flex-col items-center justify-center py-2 px-5 rounded-lg border-2 border-gray-300 opacity-70 cursor-not-allowed w-max\"\r\n                      style={{ backgroundColor: fragance.color }}\r\n                    >\r\n                      <span className=\"text-white font-semibold\">{fragance.name}</span>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n\r\n            <button\r\n              onClick={handleAddToCart}\r\n              className=\"mt-6 bg-green-500 text-white px-6 py-2 rounded-lg\"\r\n            >\r\n              Añadir al carrito\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Mostrar la descripción de la fragancia seleccionada (solo si está disponible) */}\r\n      {(selectedFragance || selectedNextFragance) && (\r\n        <>\r\n           <div className=\"mt-4 p-4 border-t-2 border-gray-300 max-w-xl mx-auto\">\r\n         <div className=\"flex items-center justify-center mb-4\">\r\n         <label className=\"mr-2 text-sm font-medium text-gray-700\">\r\n           Intensidad:\r\n         </label>\r\n         <div className=\"flex gap-1\">\r\n           {/* Usar la fragancia seleccionada, ya sea fragance o nextFragance */}\r\n           {(selectedFragance || selectedNextFragance).intensity &&\r\n             Array.from({ length: 5 }).map((_, index) => (\r\n               <span\r\n                 key={index}\r\n                 className={`w-3 h-3 rounded-full ${\r\n                   index < (selectedFragance || selectedNextFragance).intensity\r\n                     ? \"bg-black\"\r\n                     : \"bg-gray-300\"\r\n                 }`}\r\n               ></span>\r\n             ))}\r\n         </div>\r\n       </div>\r\n\r\n\r\n\r\n          <h3 className=\"text-lg font-bold\">\r\n            {(selectedFragance || selectedNextFragance).name}\r\n          </h3>\r\n          <p className=\"text-gray-600\">\r\n            {(selectedFragance || selectedNextFragance).description}\r\n          </p>\r\n        </div>\r\n\r\n             {/* Texto de \"Próximamente disponible\" */}\r\n            {selectedNextFragance && (\r\n              <div className=\"text-center text-sm text-gray-600 font-semibold mb-4\">\r\n                Próximamente disponible\r\n              </div>\r\n            )}\r\n        </>\r\n      )}\r\n\r\n\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 415, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}